<!doctype html>
<html lang="en">
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		<title>Music for a Series of Scenes</title>
		<meta name="description" content="An introduction to a video series on re-contextualization in film and music.">
		<link rel="alternate" href="/feed/feed.xml" type="application/atom+xml" title="Jackson">
		<link rel="alternate" href="/feed/feed.json" type="application/json" title="Jackson">
		<style>
			/* Defaults */
:root {
	--font-family: -apple-system, system-ui, sans-serif;
	--font-family-monospace: Consolas, Menlo, Monaco, Andale Mono WT, Andale Mono,
		Lucida Console, Lucida Sans Typewriter, DejaVu Sans Mono,
		Bitstream Vera Sans Mono, Liberation Mono, Nimbus Mono L, Courier New,
		Courier, monospace;
}

/* Theme colors */
:root {
	color-scheme: light dark;

	--color-gray-20: #333333;
	--color-gray-50: #7f7f7f;
	--color-gray-90: #e5e5e5;

	--syntax-tab-size: 2;
}
.dark-mode {
	--color-gray-20: #cccccc;
	--color-gray-50: #808080;
	--color-gray-90: #1a1a1a;
}
/* @media (prefers-color-scheme: dark) {
	:root {
		--color-gray-20: #cccccc;
		--color-gray-50: #808080;
		--color-gray-90: #1a1a1a;
	}
} */

/* Global stylesheet */
* {
	box-sizing: border-box;
}

html,
body {
	padding: 0;
	margin: 0 auto;
	font-family: var(--font-family);
	background-color: var(--background-color);
}
html {
	overflow-y: scroll;
}
body {
	max-width: 40em;
}

/* https://www.a11yproject.com/posts/how-to-hide-content/ */
.visually-hidden {
	clip: rect(0 0 0 0);
	clip-path: inset(50%);
	height: 1px;
	overflow: hidden;
	position: absolute;
	white-space: nowrap;
	width: 1px;
}

p:last-child {
	margin-bottom: 0;
}
p {
	line-height: 1.5;
}

li {
	line-height: 1.5;
}

main {
	padding: 1rem;
}
main :first-child {
	margin-top: 0;
}

header {
	position: relative;
}

:root {
	--wave-width: 30px;
	--wave-height: 10px;
}

.wave-divider {
	width: 100%;
	height: var(--wave-height);
	background: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='60' height='10'%3E%3Cpath d='M0 5q15-5 30 0t30 0' stroke='lightgray' fill='none' stroke-width='1.5'/%3E%3C/svg%3E")
		repeat-x bottom;
	background-size: var(--wave-width) var(--wave-height);
}

.links-nextprev {
	list-style: none;
	border-top: 1px dashed var(--color-gray-20);
	padding: 1em 0;
}

table {
	margin: 1em 0;
}
table td,
table th {
	padding-right: 1em;
}

pre,
code {
	font-family: var(--font-family-monospace);
}
pre:not([class*="language-"]) {
	margin: 0.5em 0;
	line-height: 1.375; /* 22px /16 */
	-moz-tab-size: var(--syntax-tab-size);
	-o-tab-size: var(--syntax-tab-size);
	tab-size: var(--syntax-tab-size);
	-webkit-hyphens: none;
	-ms-hyphens: none;
	hyphens: none;
	direction: ltr;
	text-align: left;
	white-space: pre;
	word-spacing: normal;
	word-break: normal;
}
code {
	word-break: break-all;
}

/* Header */
header {
	display: flex;
	gap: 1em 0.5em;
	flex-wrap: wrap;
	align-items: center;
	padding: 1em;
}
.home-link {
	font-size: 1em; /* 16px /16 */
	font-weight: 700;
	margin-right: 2em;
}
.home-link:link:not(:hover) {
	text-decoration: none;
}

/* Nav */
nav {
	display: flex;
	position: relative;
	padding: 0;
	margin: 0;
	list-style: none;
}
.nav-item {
	display: inline-block;
	padding: 0.25em 0;
}
.nav-item a[href]:not(:hover) {
	text-decoration: none;
}
.nav a[href][aria-current="page"] {
	text-decoration: underline;
}

/* Posts list */
.postlist {
	list-style: none;
	padding: 0;
}
.postlist-item {
	display: flex;
	flex-wrap: wrap;
	align-items: baseline;
	margin-bottom: 1em;
	padding-left: 1.5em; /* Add left padding to make room for the arrow */
	position: relative;
}
.postlist-item::before {
	content: "\2192"; /* Default to arrow */
	margin-right: 0.5em;
	color: var(--color-gray-20);
	left: 0;
	top: 0.2em;
	position: absolute;
	transition: all 0.5s ease-out;
	filter: saturate(100%);
	transform: scale(1);
}
.postlist-item[data-emoji]::before {
	content: attr(data-emoji);
}
.postlist-item::before {
	transition: all 0.5s ease-out;
}
.postlist-item:hover::before,
.postlist-item:focus-within::before {
	animation: pulseSat 2s linear infinite;
}

.postlist-item:not(:hover)::before {
	animation: none;
	filter: saturate(100%);
	transform: scale(1);
	transition: all 0.5s ease-out;
}
@keyframes pulseSat {
	0%,
	50%,
	100% {
		filter: saturate(100%);
		transform: scale(1);
	}
	25% {
		filter: saturate(50%);
		transform: scale(0.8);
	}
	75% {
		filter: saturate(150%);
		transform: scale(1.2);
	}
}
.postlist-date {
	color: var(--color-gray-20);
	font-size: 0.8125em; /* 13px /16 */
	word-spacing: -0.5px;
}
.postlist-link {
	font-size: 1.1875em; /* 19px /16 */
	font-weight: 700;
	flex-basis: 100%;
	text-underline-position: from-font;
	text-underline-offset: 0;
	text-decoration-thickness: 1px;
}
.postlist-item {
	position: relative;
}

.postlist-item:has(.postlist-link:hover) .postlist-date::after {
	content: attr(data-tooltip);
	padding-left: 1em;
	position: absolute;
	color: var(--color-gray-20);
	white-space: nowrap;
	overflow: hidden;
	text-overflow: ellipsis;
	/* BUG - This needs to be set to the width of the postlist-item */
	max-width: calc(100% - 12em);
}
.postlist-item-active .postlist-link {
	font-weight: bold;
}

/* Tags */
.post-tag {
	display: inline-flex;
	align-items: center;
	justify-content: center;
	text-transform: capitalize;
	font-style: italic;
}
.postlist-item > .post-tag {
	align-self: center;
}

/* Tags list */
.post-metadata {
	display: inline-flex;
	flex-wrap: wrap;
	gap: 0.5em;
	list-style: none;
	padding: 0;
	margin: 0;
}
.post-metadata time {
	margin-right: 1em;
}

/* Direct Links / Markdown Headers */
.header-anchor {
	text-decoration: none;
	font-style: normal;
	font-size: 1em;
	margin-left: 0.1em;
}
a[href].header-anchor,
a[href].header-anchor:visited {
	color: transparent;
}
a[href].header-anchor:focus,
a[href].header-anchor:hover {
	text-decoration: underline;
}
a[href].header-anchor:focus,
:hover > a[href].header-anchor {
	color: #aaa;
}

h2 + .header-anchor {
	font-size: 1.5em;
}

/* Starting custom */
/* @font-face {
	font-family: "Sans Serif Shaded";
	src: url("/font/SansSerifShaded.ttf");
	font-weight: normal;
	font-style: normal;
}
@font-face {
	font-family: "Bonbance";
	src: url("/font/Bonbance-BoldCondensed.woff2") format("woff2");
	font-weight: normal;
	font-style: normal;
}
@font-face {
	font-family: "AntiqueSerie";
	src: url("/font/AntiqueSerie-Regular.woff2") format("woff2");
	font-weight: normal;
	font-style: normal;
}
@font-face {
	font-family: "Anybody";
	src: url("/font/Anybody-VariableFont_wdth,wght.ttf") format("ttf");
	font-weight: normal;
	font-style: normal;
}
@font-face {
	font-family: "Folio";
	src: url("/font/Folio-Std-Light.woff") format("woff");
	font-weight: normal;
	font-style: normal;
}
@font-face {
	font-family: "Whirlybats";
	src: url("/font/Whirlybats.ttf") format("truetype");
}
@font-face {
	font-family: "WhirlyBirdie";
	src: url("/font/WhirlyBirdieVariable.ttf") format("truetype");
	font-weight: 200;
	font-variation-settings:
		"wght" 75,
		"wdth" 75;
} */
@font-face {
	font-family: "Switzer";
	src: url("/font/Switzer-Variable.woff2") format("woff2");
	font-weight: 500;
	font-display: swap;
	/* font-variation-settings: "wght" 400; */
}
@font-face {
	font-family: "Rag";
	src:
		url("/font/Rag-Regular.woff2") format("woff2"),
		url("/font/Rag-Italic.woff2") format("woff2"),
		url("/font/Rag-Bold.woff2") format("woff2"),
		url("/font/Rag-BoldItalic.woff2") format("woff2");
	font-weight: 400;
	font-style: normal italic;
	font-display: swap;
}

.wb-icon {
	font-family: "Whirlybats";
	font-weight: normal;
	font-style: normal;
	display: inline-block;
	white-space: nowrap;
	word-wrap: normal;
	direction: ltr;
	font-feature-settings: "liga";
	-webkit-font-smoothing: antialiased;
	text-rendering: optimizeLegibility;
	-moz-osx-font-smoothing: grayscale;
}

:root {
	--font-family: "Rag", -apple-system, system-ui, sans-serif;
}

h1,
h2,
h3,
.letter {
	font-family: "Switzer";
}

h1 {
	display: flex;
	flex-wrap: wrap;
	gap: 0.25em;
}

header {
	gap: unset;
}

nav {
	/* padding-bottom: 0.5em; */
	width: 100%;
	align-items: baseline;
	display: flex;
}

.nav-toggle {
	margin-left: auto;
}

figure {
	display: flex;
	flex-direction: column;
	align-items: center;
}

figure > * {
	max-width: 100%;
}

figcaption {
	color: var(--color-gray-20);
	text-align: center;
}

blockquote {
	padding-left: 1em;
	border-left: 2px solid ButtonFace;
}

/* Talk bubble */
.talk-bubble {
	position: relative;
	width: calc(100% - 2.5em);
	background: ButtonFace;
	border-radius: 5px;
	padding: 0.125em;
	margin: 0;
	align-items: center;
	justify-content: space-between;
	display: flex;
}

.talk-bubble:after {
	content: "";
	position: absolute;
	right: -7.5px;
	top: 50%;
	border: 7.5px solid transparent;
	border-left-color: ButtonFace;
	border-right: 0;
	margin-top: -7.5px;
}

.side-nav {
	margin-right: 2.25em;
	width: 100%;
	justify-content: center;
}

.nav-list {
	margin: 0;
	z-index: 1;
	list-style: none;
	display: flex;
	flex-direction: column;
	padding-inline-start: 0;
	width: 100%;
	text-align: center;
}

.nav-phrase {
	padding: 0 0.5em;
}

.nav-toggle {
	margin-top: 0.25em;
	position: relative;
	right: -2em;
}

@media (max-width: 839px) {
	/* Desktop */
	.side-nav {
		display: none;
	}
	/* Mobile */
	.nav-phrase {
		display: inherit;
	}
}

@media (min-width: 840px) {
	.side-nav {
		display: inherit;
	}
	.nav-phrase {
		display: none;
	}
}

header {
	padding-bottom: 0;
}

/* Custom header */
@media (min-width: 840px) {
	body {
		display: flex;
		justify-content: center;
		max-width: none;
		padding: 0;
	}

	.content-wrapper {
		display: flex;
		max-width: calc(40em + 200px + 1rem);
		width: 100%;
	}

	.side-header {
		position: sticky;
		top: 0;
		height: 100vh;
		width: 200px;
		overflow-y: auto;
		align-items: start;
		justify-content: end;
	}

	.side-header .nav {
		flex-direction: column;
		align-items: end;
	}

	main {
		flex: 1;
		max-width: 40em;
		padding: 1rem;
	}

	.wave-divider {
		width: var(--wave-height);
		height: 150px;
		background: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='10' height='60'%3E%3Cpath d='M5 0q-5 15 0 30t0 30' stroke='lightgray' fill='none' stroke-width='1.5'/%3E%3C/svg%3E")
			repeat-y right;
		background-size: var(--wave-height) var(--wave-width);
		margin-left: 1em;
		color: green;
		stroke: green;
	}

	/* Talk bubble movement */
	.side-header {
		--item-top: 12px;
		--item-rot: 0deg;
		--nav-item-height: 32px;
	}

	.talk-bubble {
		position: absolute;
		/* margin: 0.25em; */
	}

	.talk-bubble,
	.nav-toggle {
		transition: all 0.3s ease;
	}

	.talk-bubble {
		transform: translateY(calc(var(--item-top) - 12px));
	}

	.nav-toggle {
		transform: rotate(var(--item-rot));
	}

	.side-header:has(.nav-item:nth-child(1):hover) {
		--item-top: calc(12px + 0 * var(--nav-item-height));
	}
	.side-header:has(.nav-item:nth-child(2):hover) {
		--item-top: calc(12px + 1 * var(--nav-item-height));
		--item-rot: -15deg;
	}
	.side-header:has(.nav-item:nth-child(3):hover) {
		--item-top: calc(12px + 2 * var(--nav-item-height));
		--item-rot: 15deg;
	}
	.side-header:has(.nav-item:nth-child(4):hover) {
		--item-top: calc(12px + 3 * var(--nav-item-height));
		--item-rot: -15deg;
	}
}

/* :root {
	color-scheme: light dark;

	--color-gray-20: light-dark(#333333, #cccccc);
	--color-gray-50: light-dark(#7f7f7f, #808080);
	--color-gray-90: light-dark(#e5e5e5, #1a1a1a);
} */

:root {
	color-scheme: light;
	--color-bg: white;
	--color-gray-20: #333333;
	--color-gray-50: #7f7f7f;
	--color-gray-90: #e5e5e5;
}

:root[data-theme="dark"] {
	color-scheme: dark;
	--color-bg: black;
	--color-gray-20: #cccccc;
	--color-gray-50: #808080;
	--color-gray-90: #1a1a1a;
}

body {
	color: CanvasText;
	background-color: Canvas;
	/* transition:
		color 0.1s,
		background-color 0.1s; */
}

#dark-mode-toggle {
	display: none;
}

#dark-mode-toggle + label {
	background: none;
	border: none;
	cursor: pointer;
	font-size: 1em;
}

#dark-mode-toggle + label::before {
	content: "🐓";
}

#dark-mode-toggle:checked + label::before {
	content: "🐸";
}

@media (prefers-color-scheme: dark) {
	#dark-mode-toggle:not(:checked) + label::before {
		content: "🐓";
	}
	#dark-mode-toggle:checked + label::before {
		content: "🐸";
	}
}

:root:has(#dark-mode-toggle:checked) {
	color-scheme: dark;
}

:root:has(#dark-mode-toggle:not(:checked)) {
	color-scheme: light;
}
		</style>
	</head>
	<body>
		<a href="#skip" class="visually-hidden">Skip to main content</a>
		<div class="content-wrapper">
			<header class="side-header">
				<nav>
					<h2 class="visually-hidden">Top level navigation menu</h2>
					<div class="talk-bubble" >
						<div id="chatBubble" class="nav-phrase" data-original-content="Welcome">
							
						</div>
						<form method="post"  id="theme-form" class="nav-toggle">
							<input type="checkbox" id="dark-mode-toggle" name="theme" value="dark" aria-label="Toggle dark mode">
							<label for="dark-mode-toggle"></label>
						</form>
					</div>
					<div class="side-nav">
						<ul class="nav-list">
								<li class="nav-item">
									<a href="/">Home</a>
								</li>
								<li class="nav-item">
									<a href="/blog/">Blog</a>
								</li>
								<li class="nav-item">
									<a href="/projects/">Projects</a>
								</li>
								<li class="nav-item">
									<a href="/about/">About Me</a>
								</li>
						</ul>
					</div>
				</nav>

				
			</header>

			<main id="skip" class="container">
				<link rel="stylesheet" href="/css/lite-yt-embed.css"/>

<h1>Music for a Series of Scenes</h1>

<ul class="post-metadata">
	<li>
		<time datetime="2020-10-23">23 October 2020</time>
	</li>
</ul>

<p>Film has always been a big part of my life, as entertainment, education, and artistic inspiration. Towards the end of high school my taste in all things artistic broadened past the &quot;indie&quot; titles often found on the shelves of Urban Outfitters (forgive me) directly into the obscure. While diving into the archives of cult cinema, midnight movies and the like was entertaining on its own for the shock and awe, it was like the thrill of driving for the first time but unaware of the vistas you're passing by. Unfortunately, it took me a lot of movies to get a taste for the landscape of cinema and even now I have plenty of room to grow.</p>
<p>As I have continued to explore the wakes of history through my 13.3in portal I've always felt some interest in the continuities between film and music. Often soundtracks highlight the emotional emphasis of a scene or tend to cast a feelings across moments or to even color the mood of the film as a whole. Less often does a film employ music that has existed prior to the film itself. There could be lots of reasons for why a director might want to avoid this: copyright/licencing, its potentially abrupt intrusion, or, what I suspect is largely the case, the meaning that a song could carry with it into the film. The appearance of a song from the past (especially if it is particularly well-known) can dramatically color the viewing experience of that scene and the movie as a whole. In cases where a song fits beautifully into a scene, you can tell the director had either imagined this song as its backdrop before getting behind the camera or was just incredibly intuitive/lucky.</p>
<h1 id="a-potential-project" tabindex="-1">A potential project <a class="header-anchor" href="#a-potential-project">#</a></h1>
<p>This dilemma has led me to imagine the possibilities of re-contextualizing films under new soundtracks, perhaps ones made even after the film. This pieces would have the benefit of extending upon not just the legacy of the song, as a director would if they included it in their film, but also the film itself. This imagined production would appropriate the history of the film as well the song that was chosen to fit the scene. I imagined that these shorts would be akin to painting with a new pallette - brief glimpses of a familiar world (sonic and visually) that was re-imagined through new positionings in sound, image, and history. These short clips would also serve to highlight potentially uncommon works in ways that might elevate them, inject a rush of novelty, or critically expose angles of the works that could not be focused on in a standard viewing.</p>
<p>I hope to continue making these shorts both for satisfying ideas I've had in the log and for getting some experience with video editing. In this first blog, I'll talk about two of the shorts I've done and the stories that accompany my choices.</p>
<h2 id="funeral-parade-of-roses" tabindex="-1"><em>Funeral Parade of Roses</em> <a class="header-anchor" href="#funeral-parade-of-roses">#</a></h2>
<figure>
    <div class="iframe-wrapper pb-137">
        <iframe title="vimeo-player" src="https://player.vimeo.com/video/457926908?h=4a1c9e404d&title=0&byline=0&portrait=0" frameborder="0" allowfullscreen></iframe>
    </div>
    <figcaption><cite>Funeral Parade of Roses</cite></figcaption>
</figure>
<p>One of my favorite films that I've seen over the last few years, and beyond that, is the first feature length film by art-house director Toshio Matsumoto. The film was firmly situated in the <a href="https://en.wikipedia.org/wiki/Japanese_New_Wave">Japanese New Wave</a> led by the Art Theatre Guild production company. To say that <em>Funeral Parade of Roses</em> is unlike most films is an understatement. Without giving too much away, Roses follows the life of Peter, a young transvestite (or more likely transgender, in a modern context) through the underground gay scene of 1960's Tokyo.</p>
<p>Even more unusual is that many scenes from the film interview and discuss the lives of the actors, their thoughts and opinions of the film they're working in, and even include shots of the film set. But these scenes are not the only that break from the standard plot, there are countless sequences that flirt with mischief, eroticism, and terror in a bold visual style all their own. There's also a dash of Greek mythology and drug use - 1969 seemed to be a wild year everywhere.</p>
<p>For Roses, I ended up landing on a an artist I had been introduced to by the director Apichatpong Weerasethakul in the erie, final scene of his last film <em>Cemetary of Splendour</em>. DJ Soulscape is a Korean producer whose 2003 album <em>Lovers:</em> is a collection of samples ranging from downbeat electronic to hip-hop - navigating between the legacies of Nujabes and Air. The first track off Lovers:, &quot;People&quot; begins with a piano bang, reminiscent of &quot;A Day in the Life&quot;, and builds over new samples in each measure. It's a wonderfully cinematic track and really grooves when the bass line kicks in.</p>
<h2 id="suspiria" tabindex="-1"><em>Suspiria</em> <a class="header-anchor" href="#suspiria">#</a></h2>
<figure>
    <div class="iframe-wrapper pb-235">
    <iframe title="vimeo-player" src="https://player.vimeo.com/video/471716567?h=33439aee12&title=0&byline=0&portrait=0" frameborder="0" allowfullscreen></iframe>
    </div>
    <figcaption><cite>Suspiria</cite></figcaption>
</figure>
<p><em>Suspiria</em> was a film that I had wanted to see for a while. An Italian film with an American lead actress and casting from both Italy and Germany, it was quite an ambitious project and one where many of the actors simply spoke in their native language to be overdubbed. But besides the logistics, <em>Suspiria</em> is known as a staple of the euro-horror genre.</p>
<p>Compared to <em>Roses</em>, the music in this case actually informed the choice of the film. The song chosen comes from Claudine Longet, a French-American popular for covering American and Brazilian standards in the 60's and 70's as well as for being married to Andy Williams for a decade in that period. However, her career was cut short by a murder trial of her new boyfriend in Aspen, 1976. This was a widely publicized trial, mired by slipups from the persecution and the police and ended with a light sentence of a month in jail, a small fine, and with breaks on the weekend to see her kids. Even more incredible was that Longet made off with her defense attorney post-trail. They still live in Aspen.</p>
<p>Given the hefty settlements made to the victims family later, the validity of the trail is heavily disputed. The legacy of Claudine Longet that creeps under her lighthearted vocal performances made a perfect mix for a horror film like <em>Suspiria</em>. &quot;Here, There and Everywhere&quot; is a track written by The Beatles' Paul McCartney - one of his favorites and covered widely. Longet's take (or likely Tommy LiPuma's, as producer) is quite strange, with syncopated drums and pizzicato violins, quiet guitar and a single, haunting lead vocal.</p>
<h2 id="for-more" tabindex="-1">For more <a class="header-anchor" href="#for-more">#</a></h2>
<p>To see more shorts from this ongoing series, you can find the showcase, hosted on Vimeo, <a href="https://vimeo.com/showcase/7853493">here</a>.</p>

		<ul class="links-nextprev">
				<li>Previous: <a href="/blog/2020-10-16-musings-bela/">Musings with Bela</a>
				</li>
			
				<li>Next: <a href="/blog/2021-05-14-meet-in-space/">Toward a Telepresence of Sound: Video Conferencing in Spatial Audio</a>
				</li>
			
		</ul>

<script src="/js/lite-yt-embed.js" defer></script>
<script type="module" src="https://cdn.jsdelivr.net/npm/lite-vimeo-embed/+esm" defer></script>
			</main>
		</div>
		<footer></footer>

		<!-- This page `/blog/2020-10-23-film-for-music/` was built on 2024-08-23T08:34:23.506Z -->
	</body>
</html>
<script defer>
	// Minimal JS for handling user preference
(function () {
    const toggle = document.getElementById('dark-mode-toggle');

    // Set initial state based on localStorage or system preference
    const storedTheme = localStorage.getItem('color-scheme');
    if (storedTheme) {
        document.documentElement.setAttribute('data-theme', storedTheme);
        toggle.checked = storedTheme === 'dark';
    }

    // Handle toggle changes
    toggle.addEventListener('change', () => {
        const newTheme = toggle.checked ? 'dark' : 'light';
        document.documentElement.setAttribute('data-theme', newTheme);
        localStorage.setItem('color-scheme', newTheme);
    });

    // const form = document.getElementById('theme-form');
    // Handle form submission (for no-JS fallback)
    // form.addEventListener('submit', (e) => {
    //     e.preventDefault();
    //     const formData = new FormData(form);
    //     fetch('/set-theme', {
    //         method: 'POST',
    //         body: formData
    //     }).then(() => {
    //         location.reload();
    //     });
    // });
})();
</script>
<script>
	const chatBubble = document.getElementById('chatBubble');
	const originalContent = chatBubble.dataset.originalContent;
	let isInputMode = false;

	chatBubble.addEventListener('click', function () {
		if (!isInputMode) {
			isInputMode = true;
			chatBubble.innerHTML = '<input type="text" id="chatInput" placeholder="Type your message...">';
			document
				.getElementById('chatInput')
				.focus();
		}
	});

	document.addEventListener('keypress', function (e) {
		if (e.key === 'Enter' && isInputMode) {
			const input = document.getElementById('chatInput');
			const message = input.value;
			if (message) {
				chatBubble.innerHTML = 'Processing...';
				sendMessageToWorker(message);
			}
		}
	});

	function sendMessageToWorker(message) {
		chatBubble.textContent = '';
		const eventSource = new EventSource(`/?talk=${encodeURIComponent(message)}`);

		eventSource.onmessage = (event) => {
			const data = event.data;
			if (data !== '[DONE]') {
				try {
					const parsed = JSON.parse(data);
					if (parsed.response) {
						chatBubble.textContent += parsed.response;
					}
				} catch (error) {
					console.error('Error parsing JSON:', error);
					chatBubble.textContent += data;
				}
			} else {
				eventSource.close();
				isInputMode = false;
			}
		};

		eventSource.onerror = (error) => {
			console.error('EventSource failed:', error);
			eventSource.close();
			isInputMode = false;
			if (!chatBubble.textContent) {
				chatBubble.textContent = originalContent;
			}
		};
	}
</script>