<!doctype html>
<html lang="en">
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		<title>Montreal</title>
		<meta name="description" content="A reflection on visiting Montreal, exploring its French influence, cultural shifts, and urban landscape.">
		<link rel="alternate" href="/feed/feed.xml" type="application/atom+xml" title="Jackson">
		<link rel="alternate" href="/feed/feed.json" type="application/json" title="Jackson">
		<style>
			/* Defaults */
:root {
	--font-family: -apple-system, system-ui, sans-serif;
	--font-family-monospace: Consolas, Menlo, Monaco, Andale Mono WT, Andale Mono,
		Lucida Console, Lucida Sans Typewriter, DejaVu Sans Mono,
		Bitstream Vera Sans Mono, Liberation Mono, Nimbus Mono L, Courier New,
		Courier, monospace;
}

/* Theme colors */
:root {
	color-scheme: light dark;

	--color-gray-20: #333333;
	--color-gray-50: #7f7f7f;
	--color-gray-90: #e5e5e5;

	--syntax-tab-size: 2;
}
.dark-mode {
	--color-gray-20: #cccccc;
	--color-gray-50: #808080;
	--color-gray-90: #1a1a1a;
}
/* @media (prefers-color-scheme: dark) {
	:root {
		--color-gray-20: #cccccc;
		--color-gray-50: #808080;
		--color-gray-90: #1a1a1a;
	}
} */

/* Global stylesheet */
* {
	box-sizing: border-box;
}

html,
body {
	padding: 0;
	margin: 0 auto;
	font-family: var(--font-family);
	background-color: var(--background-color);
}
html {
	overflow-y: scroll;
}
body {
	max-width: 40em;
}

/* https://www.a11yproject.com/posts/how-to-hide-content/ */
.visually-hidden {
	clip: rect(0 0 0 0);
	clip-path: inset(50%);
	height: 1px;
	overflow: hidden;
	position: absolute;
	white-space: nowrap;
	width: 1px;
}

p:last-child {
	margin-bottom: 0;
}
p {
	line-height: 1.5;
}

li {
	line-height: 1.5;
}

main {
	padding: 1rem;
}
main :first-child {
	margin-top: 0;
}

header {
	position: relative;
}

:root {
	--wave-width: 30px;
	--wave-height: 10px;
}

.wave-divider {
	width: 100%;
	height: var(--wave-height);
	background: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='60' height='10'%3E%3Cpath d='M0 5q15-5 30 0t30 0' stroke='lightgray' fill='none' stroke-width='1.5'/%3E%3C/svg%3E")
		repeat-x bottom;
	background-size: var(--wave-width) var(--wave-height);
}

.links-nextprev {
	list-style: none;
	border-top: 1px dashed var(--color-gray-20);
	padding: 1em 0;
}

table {
	margin: 1em 0;
}
table td,
table th {
	padding-right: 1em;
}

pre,
code {
	font-family: var(--font-family-monospace);
}
pre:not([class*="language-"]) {
	margin: 0.5em 0;
	line-height: 1.375; /* 22px /16 */
	-moz-tab-size: var(--syntax-tab-size);
	-o-tab-size: var(--syntax-tab-size);
	tab-size: var(--syntax-tab-size);
	-webkit-hyphens: none;
	-ms-hyphens: none;
	hyphens: none;
	direction: ltr;
	text-align: left;
	white-space: pre;
	word-spacing: normal;
	word-break: normal;
}
code {
	word-break: break-all;
}

/* Header */
header {
	display: flex;
	gap: 1em 0.5em;
	flex-wrap: wrap;
	align-items: center;
	padding: 1em;
}
.home-link {
	font-size: 1em; /* 16px /16 */
	font-weight: 700;
	margin-right: 2em;
}
.home-link:link:not(:hover) {
	text-decoration: none;
}

/* Nav */
nav {
	display: flex;
	position: relative;
	padding: 0;
	margin: 0;
	list-style: none;
}
.nav-item {
	display: inline-block;
	padding: 0.25em 0;
}
.nav-item a[href]:not(:hover) {
	text-decoration: none;
}
.nav a[href][aria-current="page"] {
	text-decoration: underline;
}

/* Posts list */
.postlist {
	list-style: none;
	padding: 0;
}
.postlist-item {
	display: flex;
	flex-wrap: wrap;
	align-items: baseline;
	margin-bottom: 1em;
	padding-left: 1.5em; /* Add left padding to make room for the arrow */
	position: relative;
}
.postlist-item::before {
	content: "\2192"; /* Default to arrow */
	margin-right: 0.5em;
	color: var(--color-gray-20);
	left: 0;
	top: 0.2em;
	position: absolute;
	transition: all 0.5s ease-out;
	filter: saturate(100%);
	transform: scale(1);
}
.postlist-item[data-emoji]::before {
	content: attr(data-emoji);
}
.postlist-item::before {
	transition: all 0.5s ease-out;
}
.postlist-item:hover::before,
.postlist-item:focus-within::before {
	animation: pulseSat 2s linear infinite;
}

.postlist-item:not(:hover)::before {
	animation: none;
	filter: saturate(100%);
	transform: scale(1);
	transition: all 0.5s ease-out;
}
@keyframes pulseSat {
	0%,
	50%,
	100% {
		filter: saturate(100%);
		transform: scale(1);
	}
	25% {
		filter: saturate(50%);
		transform: scale(0.8);
	}
	75% {
		filter: saturate(150%);
		transform: scale(1.2);
	}
}
.postlist-date {
	color: var(--color-gray-20);
	font-size: 0.8125em; /* 13px /16 */
	word-spacing: -0.5px;
}
.postlist-link {
	font-size: 1.1875em; /* 19px /16 */
	font-weight: 700;
	flex-basis: 100%;
	text-underline-position: from-font;
	text-underline-offset: 0;
	text-decoration-thickness: 1px;
}
.postlist-item {
	position: relative;
}

.postlist-item:has(.postlist-link:hover) .postlist-date::after {
	content: attr(data-tooltip);
	padding-left: 1em;
	position: absolute;
	color: var(--color-gray-20);
	white-space: nowrap;
	overflow: hidden;
	text-overflow: ellipsis;
	/* BUG - This needs to be set to the width of the postlist-item */
	max-width: calc(100% - 12em);
}
.postlist-item-active .postlist-link {
	font-weight: bold;
}

/* Tags */
.post-tag {
	display: inline-flex;
	align-items: center;
	justify-content: center;
	text-transform: capitalize;
	font-style: italic;
}
.postlist-item > .post-tag {
	align-self: center;
}

/* Tags list */
.post-metadata {
	display: inline-flex;
	flex-wrap: wrap;
	gap: 0.5em;
	list-style: none;
	padding: 0;
	margin: 0;
}
.post-metadata time {
	margin-right: 1em;
}

/* Direct Links / Markdown Headers */
.header-anchor {
	text-decoration: none;
	font-style: normal;
	font-size: 1em;
	margin-left: 0.1em;
}
a[href].header-anchor,
a[href].header-anchor:visited {
	color: transparent;
}
a[href].header-anchor:focus,
a[href].header-anchor:hover {
	text-decoration: underline;
}
a[href].header-anchor:focus,
:hover > a[href].header-anchor {
	color: #aaa;
}

h2 + .header-anchor {
	font-size: 1.5em;
}

/* Starting custom */
/* @font-face {
	font-family: "Sans Serif Shaded";
	src: url("/font/SansSerifShaded.ttf");
	font-weight: normal;
	font-style: normal;
}
@font-face {
	font-family: "Bonbance";
	src: url("/font/Bonbance-BoldCondensed.woff2") format("woff2");
	font-weight: normal;
	font-style: normal;
}
@font-face {
	font-family: "AntiqueSerie";
	src: url("/font/AntiqueSerie-Regular.woff2") format("woff2");
	font-weight: normal;
	font-style: normal;
}
@font-face {
	font-family: "Anybody";
	src: url("/font/Anybody-VariableFont_wdth,wght.ttf") format("ttf");
	font-weight: normal;
	font-style: normal;
}
@font-face {
	font-family: "Folio";
	src: url("/font/Folio-Std-Light.woff") format("woff");
	font-weight: normal;
	font-style: normal;
}
@font-face {
	font-family: "Whirlybats";
	src: url("/font/Whirlybats.ttf") format("truetype");
}
@font-face {
	font-family: "WhirlyBirdie";
	src: url("/font/WhirlyBirdieVariable.ttf") format("truetype");
	font-weight: 200;
	font-variation-settings:
		"wght" 75,
		"wdth" 75;
} */
@font-face {
	font-family: "Switzer";
	src: url("/font/Switzer-Variable.woff2") format("woff2");
	font-weight: 500;
	font-display: swap;
	/* font-variation-settings: "wght" 400; */
}
@font-face {
	font-family: "Rag";
	src:
		url("/font/Rag-Regular.woff2") format("woff2"),
		url("/font/Rag-Italic.woff2") format("woff2"),
		url("/font/Rag-Bold.woff2") format("woff2"),
		url("/font/Rag-BoldItalic.woff2") format("woff2");
	font-weight: 400;
	font-style: normal italic;
	font-display: swap;
}

.wb-icon {
	font-family: "Whirlybats";
	font-weight: normal;
	font-style: normal;
	display: inline-block;
	white-space: nowrap;
	word-wrap: normal;
	direction: ltr;
	font-feature-settings: "liga";
	-webkit-font-smoothing: antialiased;
	text-rendering: optimizeLegibility;
	-moz-osx-font-smoothing: grayscale;
}

:root {
	--font-family: "Rag", -apple-system, system-ui, sans-serif;
}

h1,
h2,
h3,
.letter {
	font-family: "Switzer";
}

h1 {
	display: flex;
	flex-wrap: wrap;
	gap: 0.25em;
}

header {
	gap: unset;
}

nav {
	/* padding-bottom: 0.5em; */
	width: 100%;
	align-items: baseline;
	display: flex;
}

.nav-toggle {
	margin-left: auto;
}

figure {
	display: flex;
	flex-direction: column;
	align-items: center;
}

figure > * {
	max-width: 100%;
}

figcaption {
	color: var(--color-gray-20);
	text-align: center;
}

blockquote {
	padding-left: 1em;
	border-left: 2px solid ButtonFace;
}

/* Talk bubble */
.talk-bubble {
	position: relative;
	width: calc(100% - 2.5em);
	background: ButtonFace;
	border-radius: 5px;
	padding: 0.125em;
	margin: 0;
	align-items: center;
	justify-content: space-between;
	display: flex;
}

.talk-bubble:after {
	content: "";
	position: absolute;
	right: -7.5px;
	top: 50%;
	border: 7.5px solid transparent;
	border-left-color: ButtonFace;
	border-right: 0;
	margin-top: -7.5px;
}

.side-nav {
	margin-right: 2.25em;
	width: 100%;
	justify-content: center;
}

.nav-list {
	margin: 0;
	z-index: 1;
	list-style: none;
	display: flex;
	flex-direction: column;
	padding-inline-start: 0;
	width: 100%;
	text-align: center;
}

.nav-phrase {
	padding: 0 0.5em;
}

.nav-toggle {
	margin-top: 0.25em;
	position: relative;
	right: -2em;
}

@media (max-width: 839px) {
	/* Desktop */
	.side-nav {
		display: none;
	}
	/* Mobile */
	.nav-phrase {
		display: inherit;
	}
}

@media (min-width: 840px) {
	.side-nav {
		display: inherit;
	}
	.nav-phrase {
		display: none;
	}
}

header {
	padding-bottom: 0;
}

/* Custom header */
@media (min-width: 840px) {
	body {
		display: flex;
		justify-content: center;
		max-width: none;
		padding: 0;
	}

	.content-wrapper {
		display: flex;
		max-width: calc(40em + 200px + 1rem);
		width: 100%;
	}

	.side-header {
		position: sticky;
		top: 0;
		height: 100vh;
		width: 200px;
		overflow-y: auto;
		align-items: start;
		justify-content: end;
	}

	.side-header .nav {
		flex-direction: column;
		align-items: end;
	}

	main {
		flex: 1;
		max-width: 40em;
		padding: 1rem;
	}

	.wave-divider {
		width: var(--wave-height);
		height: 150px;
		background: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='10' height='60'%3E%3Cpath d='M5 0q-5 15 0 30t0 30' stroke='lightgray' fill='none' stroke-width='1.5'/%3E%3C/svg%3E")
			repeat-y right;
		background-size: var(--wave-height) var(--wave-width);
		margin-left: 1em;
		color: green;
		stroke: green;
	}

	/* Talk bubble movement */
	.side-header {
		--item-top: 12px;
		--item-rot: 0deg;
		--nav-item-height: 32px;
	}

	.talk-bubble {
		position: absolute;
		/* margin: 0.25em; */
	}

	.talk-bubble,
	.nav-toggle {
		transition: all 0.3s ease;
	}

	.talk-bubble {
		transform: translateY(calc(var(--item-top) - 12px));
	}

	.nav-toggle {
		transform: rotate(var(--item-rot));
	}

	.side-header:has(.nav-item:nth-child(1):hover) {
		--item-top: calc(12px + 0 * var(--nav-item-height));
	}
	.side-header:has(.nav-item:nth-child(2):hover) {
		--item-top: calc(12px + 1 * var(--nav-item-height));
		--item-rot: -15deg;
	}
	.side-header:has(.nav-item:nth-child(3):hover) {
		--item-top: calc(12px + 2 * var(--nav-item-height));
		--item-rot: 15deg;
	}
	.side-header:has(.nav-item:nth-child(4):hover) {
		--item-top: calc(12px + 3 * var(--nav-item-height));
		--item-rot: -15deg;
	}
}

/* :root {
	color-scheme: light dark;

	--color-gray-20: light-dark(#333333, #cccccc);
	--color-gray-50: light-dark(#7f7f7f, #808080);
	--color-gray-90: light-dark(#e5e5e5, #1a1a1a);
} */

:root {
	color-scheme: light;
	--color-bg: white;
	--color-gray-20: #333333;
	--color-gray-50: #7f7f7f;
	--color-gray-90: #e5e5e5;
}

:root[data-theme="dark"] {
	color-scheme: dark;
	--color-bg: black;
	--color-gray-20: #cccccc;
	--color-gray-50: #808080;
	--color-gray-90: #1a1a1a;
}

body {
	color: CanvasText;
	background-color: Canvas;
	/* transition:
		color 0.1s,
		background-color 0.1s; */
}

#dark-mode-toggle {
	display: none;
}

#dark-mode-toggle + label {
	background: none;
	border: none;
	cursor: pointer;
	font-size: 1em;
}

#dark-mode-toggle + label::before {
	content: "üêì";
}

#dark-mode-toggle:checked + label::before {
	content: "üê∏";
}

@media (prefers-color-scheme: dark) {
	#dark-mode-toggle:not(:checked) + label::before {
		content: "üêì";
	}
	#dark-mode-toggle:checked + label::before {
		content: "üê∏";
	}
}

:root:has(#dark-mode-toggle:checked) {
	color-scheme: dark;
}

:root:has(#dark-mode-toggle:not(:checked)) {
	color-scheme: light;
}
		</style>
	</head>
	<body>
		<a href="#skip" class="visually-hidden">Skip to main content</a>
		<div class="content-wrapper">
			<header class="side-header">
				<nav>
					<h2 class="visually-hidden">Top level navigation menu</h2>
					<div class="talk-bubble" >
						<div id="chatBubble" class="nav-phrase" data-original-content="Welcome">
							
						</div>
						<form method="post"  id="theme-form" class="nav-toggle">
							<input type="checkbox" id="dark-mode-toggle" name="theme" value="dark" aria-label="Toggle dark mode">
							<label for="dark-mode-toggle"></label>
						</form>
					</div>
					<div class="side-nav">
						<ul class="nav-list">
								<li class="nav-item">
									<a href="/">Home</a>
								</li>
								<li class="nav-item">
									<a href="/blog/">Blog</a>
								</li>
								<li class="nav-item">
									<a href="/projects/">Projects</a>
								</li>
								<li class="nav-item">
									<a href="/about/">About Me</a>
								</li>
						</ul>
					</div>
				</nav>

				
			</header>

			<main id="skip" class="container">
				<link rel="stylesheet" href="/css/lite-yt-embed.css"/>

<h1>Montreal</h1>

<ul class="post-metadata">
	<li>
		<time datetime="2023-08-01">01 August 2023</time>
	</li>
</ul>

<p>I didn't think  I would end up in Montreal. I think my only awareness of the city was a unit on Quebec within my French class in middle/highschool. Even then, the recollections I have are of maple syrup dripped over snow, poutine, bitter winters and ice sculptures.</p>
<p>However, it came more into focus during the last years of undergrad where thoughts towards the future, my continued education within Cognitive Science, were looming. McGill had a department and program in neuroscience which I had mentioned to my fellow cog-sci classmates thinking it would be a cool program abroad (though Canada in my mind felt far less international than anywhere else.) And I've been considering moving from Long Beach, and Montreal was always a place on my list.</p>
<p>While I ended up not pursuing down that road, remarkably, one of those close friends I mentioned this program to did! She is now close to finishing a PhD in Neuroscience studying the effects of canabanoids during prenatal development in mice. I was able to visit her during the warmest period in Montreal (flight likely discounted by the raging wildfires) and so became quite enamoured with a beautiful √©t√© in Montreal.</p>
<h2 id="french" tabindex="-1">French <a class="header-anchor" href="#french">#</a></h2>
<p>I knew there was a French influence historically (and presumably more linguistically now) but I had no idea the range to which French somewhat dominates the city (and provence) in a largely Anglophone part of the world. I was told (paraphrasing now by word of mouth) of the historical and economical (class) divide between the English speaking population and French and the historical disparity of capital and political representation that has come to represent. I was given a short history lesson from my friend's partner's mother who joined us one lunch. She has migrated from Durham, North Carolina (of all places!) and had a strong sense of Montreal's history and culture.</p>
<p>The wealthy English population took the spoils and political power during the spoils of <a href="https://en.wikipedia.org/wiki/Battle_of_the_Plains_of_Abraham">the war</a> and largely assimilated with the rest of English speaking Canada, leaving Francophones as a kind of second-class citizen. The power flipped in the 70s with the French party finally taking seats and representing Quebec and along with it, legislation to preserve French as the first language spoken in Quebec. This means oddly specific sign laws that require French being on and often above English whenever a public sign is made and requirements that any new students migrating to Quebec be taught in French-language schools (the only exception if both parents when to English speaking schools in Quebec).</p>
<h2 id="today" tabindex="-1">Today <a class="header-anchor" href="#today">#</a></h2>
<p>But this admirable push to preserve their historical uniqueness has also resulted in some unusual consequences. One is a practical isolation from opportunities within the rest of Canada and the US. Those learning French alone will inevitably struggle with the English world that surrounds them. The second is the much more unique cultural and political shifts that appeared more progressive than typically found in North America. This could be felt even whilst roaming the streets.</p>
<p>I imagine Montreal, as the seat of Quebec, will move forward on a little bit of it's own axis. Meaning, it's feels while Montreal is already quite an international city, it is a city that is actively fighting <em>for</em> a more linguistically diverse population. This is in contrast to the US where we are just starting to acknowledge that instructing children in English, who's native language or home language, is to exclude a richness of diversity (and all that entails) into the US for the sake of assimilation into a world that reflects the past. Because of these efforts to revitalize and reintegrate French on a prominently non-French side of the world (both North and South), Montreal will have to contend and fight for a kind of right to a cultural and linguistic independence (not sure if there's enough momentum to succeed but it's on the minds of the radicals!)</p>
<h2 id="sights" tabindex="-1">Sights <a class="header-anchor" href="#sights">#</a></h2>
<p>I walk quite a lot. I'm heavily inspired by other walkers like <a href="https://walkingtheworld.substack.com/">Chris Arnade</a> and <a href="https://pedestrian.substack.com/">Alex Wolfe</a>. These are people who are incredibly gifted at journaling around the worlds they walk in. For me at least, walking is a unique way of knowing the world you're in that tangibly connects you with the places and people that exist there. This experience (which I might blog on some later time) reminds me of Baudelaire's fl√¢neur, an aloof sort of person who saunters through urban modernity with a philosophical eye.</p>
<p>The architecture is this mix of sort of French European and American or maybe what would be like sort of North American, Canadian But the policies of the US have clear impacts, especially the commercial and the businesses that reside within the US have definitely taken a strong foothold in Canada as well. It makes sense given the geographical proximity.</p>
<p>I think biking, walkability, public transportation here are all very European in flavor. Likely due to early involvement of the French in city planning and transit systems. I mean the French were huge developers of train systems in Taiwan and Vietnam, I mean that has like colonial history but it makes sense why Montreal and maybe Quebec generally has a lot of really good well thought-out public transit.</p>
<h3 id="tipping" tabindex="-1">Tipping <a class="header-anchor" href="#tipping">#</a></h3>
<p>One odd thing is tipping culture. Why is it here? I would suspect or I would have suspected that such a huge complaint of like French tourists visiting the US and from chatting with like Europeans generally is that the tipping culture in the US is kind of a landmark folly that really represents more than just some nostalgic relic of the &quot;friendly American culture&quot; (read white, middle-class, suburbia), it represents clear exploitation in the service industry, a failure of the working class to rally around fair compensation, and how culture wars so easily distract us from class struggle.</p>
<p>Most Europeans think the whole concept is ridiculous and I think a lot of French tourists, many of whom packed the hostels, would think the same. I'm sure it's leaked over from the US and might represent a much more similar service industry to the US than Europe.</p>
<h3 id="cafes" tabindex="-1">Caf√©s <a class="header-anchor" href="#cafes">#</a></h3>
<p>Given that, caf√© culture is huge and the caf√©s are better compared to the US. It seems like people care more about the accessibility and quality of a place it get a cup of coffee in the neighborhood. Likely due to the poor city planning in most American cities, the neighborhood caf√© has been replaced with a suburban sprawl and lacks the charming nooks found in older European cities since no one wants to walk an hour out of your cul-de-sac to get to a caf√©.</p>
<h3 id="buildings" tabindex="-1">Buildings <a class="header-anchor" href="#buildings">#</a></h3>
<p>The city also does a good job of creating a lot of of beautiful and seemingly affordable public housing. It reminds me a lot of Oslo where a lot of apartments were built thoughtfully. They're placed in good locations and it seems like most folks get a much bigger window or a balcony. Again, these are likely nicer areas, but even in denser neighborhoods reminiscent of New York or Brooklyn, there seems to be enough open space and yards for people to make their own. That also applies to the skyline as well.</p>
<p>And it's also felt that Montreal has built alongside history, something not so common of North America (most history has been eradicated physically and culturally from Turtle Island). Montreal is lucky in the sense that it was settled in 1642 and has seen a bunch of growth after a slow period in the 80's and 90's. A lot of the old brick, industrial aesthetic blends within new constructions and renovations. Even when the brick looks new, it maintains a modern yet industrial vibe that fits with the surrounding buildings. There is near <em>constant</em> construction and repairs of the roads. It's a fun challenge navigating by bike in the city.</p>
<h3 id="coming-back" tabindex="-1">Coming back <a class="header-anchor" href="#coming-back">#</a></h3>
<p>I'm excited to return to Montreal next year (for a wedding), if only it remained as beautiful and temperate in the winter!</p>

		<ul class="links-nextprev">
				<li>Previous: <a href="/blog/2023-06-03-thought/">Thinking out Loud</a>
				</li>
			
				<li>Next: <a href="/blog/2024-05-01-cacophony/">Sound Pedro 2024: Cacophony</a>
				</li>
			
		</ul>

<script src="/js/lite-yt-embed.js" defer></script>
<script type="module" src="https://cdn.jsdelivr.net/npm/lite-vimeo-embed/+esm" defer></script>
			</main>
		</div>
		<footer></footer>

		<!-- This page `/blog/2023-07-19-montreal/` was built on 2024-08-23T08:34:23.507Z -->
	</body>
</html>
<script defer>
	// Minimal JS for handling user preference
(function () {
    const toggle = document.getElementById('dark-mode-toggle');

    // Set initial state based on localStorage or system preference
    const storedTheme = localStorage.getItem('color-scheme');
    if (storedTheme) {
        document.documentElement.setAttribute('data-theme', storedTheme);
        toggle.checked = storedTheme === 'dark';
    }

    // Handle toggle changes
    toggle.addEventListener('change', () => {
        const newTheme = toggle.checked ? 'dark' : 'light';
        document.documentElement.setAttribute('data-theme', newTheme);
        localStorage.setItem('color-scheme', newTheme);
    });

    // const form = document.getElementById('theme-form');
    // Handle form submission (for no-JS fallback)
    // form.addEventListener('submit', (e) => {
    //     e.preventDefault();
    //     const formData = new FormData(form);
    //     fetch('/set-theme', {
    //         method: 'POST',
    //         body: formData
    //     }).then(() => {
    //         location.reload();
    //     });
    // });
})();
</script>
<script>
	const chatBubble = document.getElementById('chatBubble');
	const originalContent = chatBubble.dataset.originalContent;
	let isInputMode = false;

	chatBubble.addEventListener('click', function () {
		if (!isInputMode) {
			isInputMode = true;
			chatBubble.innerHTML = '<input type="text" id="chatInput" placeholder="Type your message...">';
			document
				.getElementById('chatInput')
				.focus();
		}
	});

	document.addEventListener('keypress', function (e) {
		if (e.key === 'Enter' && isInputMode) {
			const input = document.getElementById('chatInput');
			const message = input.value;
			if (message) {
				chatBubble.innerHTML = 'Processing...';
				sendMessageToWorker(message);
			}
		}
	});

	function sendMessageToWorker(message) {
		chatBubble.textContent = '';
		const eventSource = new EventSource(`/?talk=${encodeURIComponent(message)}`);

		eventSource.onmessage = (event) => {
			const data = event.data;
			if (data !== '[DONE]') {
				try {
					const parsed = JSON.parse(data);
					if (parsed.response) {
						chatBubble.textContent += parsed.response;
					}
				} catch (error) {
					console.error('Error parsing JSON:', error);
					chatBubble.textContent += data;
				}
			} else {
				eventSource.close();
				isInputMode = false;
			}
		};

		eventSource.onerror = (error) => {
			console.error('EventSource failed:', error);
			eventSource.close();
			isInputMode = false;
			if (!chatBubble.textContent) {
				chatBubble.textContent = originalContent;
			}
		};
	}
</script>